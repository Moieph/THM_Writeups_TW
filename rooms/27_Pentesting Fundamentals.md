# Pentesting Fundamentals

**🟥 滲透測試基礎知識**

THM路徑：https://tryhackme.com/room/pentestingfundamentals

---

>> #### Task 1：什麼是滲透測試？

🧠 什麼是 Penetration Test（滲透測試）？

&nbsp;&nbsp;&nbsp;&nbsp;_滲透測試是模擬駭客攻擊的一種「合法入侵測試」_ <br>

目的在於：

- 找出系統、網頁、網路設備中的安全弱點
- 幫助企業在被真正駭客入侵前，先行修補漏洞
- 使用和駭客一樣的工具與技術（但授權合法）

📌 是一種「攻擊性測試」，但目的為 **防守強化**

---

💼 滲透測試人員（Pentester）的工作內容

| 任務階段              | 說明                      |
| ----------------- | ----------------------- |
| 1️⃣ 需求洽談          | 和企業/組織溝通測試範圍（網站？內網？設備？） |
| 2️⃣ 簽署授權（RoE）     | 確認測試是被授權的，不會觸法          |
| 3️⃣ 情資收集（Recon）   | 使用 OSINT 等方式收集目標開放資訊    |
| 4️⃣ 弱點掃描          | 掃描網站、伺服器、系統配置等是否有漏洞     |
| 5️⃣ 利用漏洞（Exploit） | 嘗試模擬入侵，取得控制權或敏感資料       |
| 6️⃣ 報告撰寫          | 呈現所有發現的問題、攻擊流程、修復建議     |
| 7️⃣ 修補驗證（可選）      | 驗證修補是否成功，進行二次測試         |

---

🧨 為什麼滲透測試很重要？

因為 **資安事件每天都在發生**！

- 📉 根據 Security Magazine：每天超過 2,200 起攻擊事件
- ⏱️ 平均每 39 秒 就發生一次攻擊
- 🏥、🏦、📦、🏫 所有行業皆有被攻擊風險

---

滲透測試可以：
- 預防資料外洩
- 降低勒索病毒入侵風險
- 強化密碼策略與身份驗證
- 發現未更新的漏洞（如 Log4Shell）

>> #### Task 2：滲透測試道德規範

⚖️ 滲透測試的 **合法性（Legality）** 與 **道德性（Ethics）**

| 題目      | 解釋                                                                                    |
| ------- | ------------------------------------------------------------------------------------- |
| **合法性** | 一切行動**必須經過系統擁有者同意**，並寫入正式的測試合約或 ROE（Rules of Engagement）中。否則即使你動機良善，也屬於「未經授權存取」，可能違法。 |
| **道德性** | 即使獲得授權，有些行為仍可能令人道德不安（例如釣魚攻擊員工、看到敏感資料）。這就牽涉到個人或公司的道德判斷。                                |


---


🎩 三種**駭客帽子（Hacker Hat）**

| Hat 類型              | 特徵              | 範例                      |
| ------------------- | --------------- | ----------------------- |
| 🧑‍💼 White Hat（白帽） | 遵守法律、遵守合約、行為道德  | 滲透測試員（Pentester）協助公司找漏洞 |
| 🩶 Grey Hat（灰帽）     | 出發點良善，但不一定合法或道德 | 攻破詐騙網站但未經授權             |
| 🦹‍♂️ Black Hat（黑帽） | 非法攻擊、勒索、賺錢、搞破壞  | 勒索病毒開發者、盜刷者             |

---

🧾 **ROE：Rules of Engagement（行動規範書）**

每次正式測試前必須簽署的文件，保障雙方權益，也是法律依據。

| 區塊                      | 說明                     | 舉例                              |
| ----------------------- | ---------------------- | ------------------------------- |
| ✅ **Permission（授權）**    | 明確授權此測試任務合法，保護測試人員不會觸法 | e.g. 公司 CEO 簽名同意                |
| 📍 **Test Scope（測試範圍）** | 明訂可測試的目標與資產範圍          | e.g. 只能針對 Web Portal，不可測試內部 ERP |
| ⚠️ **Rules（行為規則）**      | 可用與禁用的技術手段             | e.g. 禁止 DoS、可用 MITM、禁止釣魚等       |

---

✅總結：
1. 未經授權的測試 = 違法入侵（即使你是白帽）
2. ROE 決定了測試範圍與手段
3. 道德比技術更重要：你看到的資料、你執行的攻擊都需要判斷與自律

---

##### 🔐 答題：
1. You are given permission to perform a security audit on an organisation; what type of hacker would you be?
   
   您被授予對組織執行安全審計的許可權;你會是哪種類型的駭客？
   
&nbsp;&nbsp;&nbsp;&nbsp; `White Hat`

2. You attack an organisation and steal their data, what type of hacker would you be?
   
   您攻擊一個組織並竊取他們的數據，您會是哪種類型的駭客？
   
&nbsp;&nbsp;&nbsp;&nbsp; `Black Hat`

3. What document defines how a penetration testing engagement should be carried out?
   
   什麼定義了應如何進行滲透測試活動？
   
&nbsp;&nbsp;&nbsp;&nbsp; `Rules of Engagement`

>> #### Task 3：滲透測試方法

🧭 滲透測試的 6 大階段（常見流程）

| 階段                                  | 說明                                                |
| ----------------------------------- |---------------------------------------------------|
| **1️⃣ 資訊蒐集（Information Gathering）** | 利用公開資料（OSINT）了解目標，如公司官網、社群媒體、Shodan…              |
| **2️⃣ 掃描與列舉（Enumeration/Scanning）** | 掃描開放的服務、主機與漏洞，例如：Nmap、Gobuster、Nikto              |
| **3️⃣ 利用漏洞（Exploitation）**          | 利用找到的漏洞進行初步入侵，通常搭配 Metasploit、公有漏洞（如CVE）          |
| **4️⃣ 權限提升（Privilege Escalation）**  | 成功利用漏洞（Foothold）後，橫向移動（另一用戶）或垂直提升（管理員），目標是取得更大控制權 |
| **5️⃣ 滲透後行動（Post-Exploitation）**    | 例如橫向移動、資料外洩、植入後門、躲避紀錄、掌握橫向網段                      |
| **6️⃣ 撰寫報告（Reporting）**             | 記錄測試過程、風險評估、修補建議，是滲透測試中最重要的交付成果之一                 |

---

📚 主流滲透測試框架比較

| 框架                                                              | 適用場景           | 優點                   | 缺點                 |
| --------------------------------------------------------------- | -------------- | -------------------- | ------------------ |
| **OSSTMM**<br>(Open Source Security Testing Methodology Manual) | 網路設備、通信測試、物理安全 | 💡 彈性高，涵蓋廣泛，連電信都能測   | 🧠 難理解，用詞特殊，新手不易入門 |
| **OWASP**<br>(Web專用)                                            | Web 應用程式與API滲透 | ✅ 社群活躍、好理解、有Top 10列表 | ❗ 只專注Web，不適用其他系統   |
| **NIST CSF 1.1**<br>(通用資安標準)                                    | 政府、商業、關鍵基礎設施   | ✅ 標準完整、有認證、普及率高      | 😕 難以選擇版本、雲端涵蓋不夠   |
| **NCSC CAF**<br>(英國政府)                                          | 關鍵基礎設施（電力、銀行等） | 🇬🇧 官方背書、架構原則明確     | 🆕 太新，業界採用少，缺實務經驗  |

---

🧠 實務必備概念：

1. **滲透測試不只有技術**，也要會寫報告與風險說明。
2. **OWASP Top 10 是面試必考**，尤其針對 Web 安全職位。
3. **ROE（Rules of Engagement**） 是滲透測試的法律保障與行為準則。
4. **橫向 vs 垂直權限提升**：
    - 橫向（Lateral）：使用者 ➜ 另一個使用者
    - 垂直（Vertical）：使用者 ➜ 管理員（root / SYSTEM）
5. **Post-exploitation** 通常會做：
   - Pivoting（橫向移動）
   - 資料收集（Credential dumping）
   - 持久化（Maintaining access）
   - 清除痕跡（Log clearing）

---

✅ 框架怎麼選？

| 想測什麼？   | 建議用哪套？   |
|---------| -------- |
| Web App | OWASP    |
| 網路設備、通信 | OSSTMM   |
| 商業/政府標準 | NIST CSF |
| 關鍵基礎建設  | NCSC CAF |

---
##### 🔐 答題：
1. What stage of penetration testing involves using publicly available information?
   
   滲透測試的哪個階段涉及使用公開可用的資訊？
   
&nbsp;&nbsp;&nbsp;&nbsp; `Information Gathering`

2. If you wanted to use a framework for pentesting telecommunications, what framework would you use? Note: We're looking for the acronym here and not the full name.
   
   如果您想使用一個框架來對電信進行滲透測試，您會使用什麼框架？注意：我們在此處查找首字母縮略詞，而不是全名。
   
&nbsp;&nbsp;&nbsp;&nbsp; `OSSTMM`

3. What framework focuses on the testing of web applications?
   
   什麼框架專注於 Web 應用程式的測試？
   
&nbsp;&nbsp;&nbsp;&nbsp; `OWASP`

>> #### Task 4：黑盒、白盒、灰盒滲透測試

🎯 滲透測試的三種測試範疇（Scope）

| 測試類型     | 黑箱（Black-Box） | 灰箱（Grey-Box） | 白箱（White-Box）      |
|----------| ------------- | ------------ | ------------------ |
| **內部資訊** | ❌ 無           | ☑️ 部分        | ✅ 完全               |
| **需求技術** | 低（像一般使用者）     | 中（技術＋黑箱）     | 高（需要程式知識）          |
| **模擬對象** | 外部攻擊者         | 內部攻擊者 / 高階滲透 | 開發者 / 安全審查人員       |
| **測試方式** | UI互動、功能測試     | 功能測試＋邏輯思維    | 原始碼審查、邏輯驗證         |
| **所需時間** | 中等 \~ 較長      | 中等           | 最久                 |
| **優點**   | 模擬真實攻擊        | 效率高、平衡風險與效率  | 涵蓋全面、風險最低          |
| **缺點**   | 攻擊面不完整        | 仍有未知漏洞可能     | 成本高、需程式碼協助         |
| **常見場景** | Web 滲透測試、外部掃描 | 滲透測試常見預設範圍   | Secure Code Review |

---

- **實務常見的是灰箱測試（Grey-Box）**，因為企業希望你「有效率地測出漏洞」，而不是當作完全不了解的駭客。


- **白箱測試適合用於高風險系統**（如金融核心系統、安全元件），因為能最大程度找出所有邏輯與程式問題。

---
##### 🔐 答題：
1. You are asked to test an application but are not given access to its source code - what testing process is this?
   
   系統會要求您測試應用程式，但未授予您訪問其原始程式碼的許可權 - 這是什麼測試過程？
   
&nbsp;&nbsp;&nbsp;&nbsp; `Black box`

2. You are asked to test a website, and you are given access to the source code - what testing process is this?
   
   系統會要求您測試一個網站，並授予您訪問原始程式碼的許可權 - 這是怎樣的測試過程？
   
&nbsp;&nbsp;&nbsp;&nbsp; `White box`

>> #### Task 5：實踐：ACME 滲透測試

Question 1：依題旨點擊 `View site`

描述已簽署 ROE，確認合約細節

<p align="left">
  <img src="/rooms/images/27_01.png" width="600">
</p>

Information Gathering 階段，瞄準一位 ACME 的員工

<p align="left">
  <img src="/rooms/images/27_02.png" width="600">
</p>

Enumeration/Scanning 階段，針對其文章之郵件伺服器進行掃描

<p align="left">
  <img src="/rooms/images/27_03.png" width="600">
</p>

取得下列資訊

<p align="left">
  <img src="/rooms/images/27_04.png" width="600">
</p>

Exploitation 階段

<p align="left">
  <img src="/rooms/images/27_05.png" width="600">
</p>

Post-Exploitation 階段（提權行動）

<p align="left">
  <img src="/rooms/images/27_06.png" width="600">
</p>

Reporting 階段（報告及清除痕跡），獲得 Flag 🎉🎉

<p align="left">
  <img src="/rooms/images/27_07.png" width="600">
</p>

##### 🔐 答題：
1. Complete the penetration test engagement against ACME's infrastructure.
   
   完成針對 ACME 基礎設施的滲透測試專案。
   
&nbsp;&nbsp;&nbsp;&nbsp; `THM{PENTEST_COMPLETE}`